<Window x:Class="EasySave.WPF.Views.MainView"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="EasySave 2.0 â€” ProSoft" Height="750" Width="1150" MinHeight="620" MinWidth="950"
        WindowStartupLocation="CenterScreen" x:Name="RootWindow"
        Icon="/Assets/Branding/logo_sidebar.png"
        Background="{DynamicResource BgPrimary}" FontSize="12" FontFamily="Segoe UI">
    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="240"/>
            <ColumnDefinition Width="*"/>
        </Grid.ColumnDefinitions>

        <!-- ===== SIDEBAR ===== -->
        <Border Grid.Column="0" Background="{DynamicResource BgSidebar}">
            <Grid Margin="20,24,20,20">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>
                <StackPanel Grid.Row="0" Margin="0,0,0,16" HorizontalAlignment="Center">
                    <Image Source="/Assets/Branding/logo_sidebar.png" Width="128" Height="128"
                           RenderOptions.BitmapScalingMode="HighQuality" Margin="0,0,0,10"/>
                    <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                        <TextBlock x:Name="TxtLogo" Text="EasySave" FontSize="18" FontWeight="Bold" Foreground="{DynamicResource TextOnDark}"/>
                        <Border Background="{DynamicResource AccentLight}" CornerRadius="4" Padding="6,1" Margin="8,0,0,0" VerticalAlignment="Center">
                            <TextBlock Text="2.0" Foreground="{DynamicResource TextPrimary}" FontSize="9" FontWeight="Bold"/>
                        </Border>
                    </StackPanel>
                    <TextBlock x:Name="TxtSubtitle" Text="Backup management" Foreground="{DynamicResource TextOnDarkMuted}"
                               FontSize="10.5" Margin="0,4,0,0" HorizontalAlignment="Center"/>
                </StackPanel>
                <StackPanel Grid.Row="1">
                    <Button x:Name="BtnNavJobs" Content="Jobs" Style="{StaticResource BtnNav}" Click="BtnNavJobs_Click" Margin="0,0,0,4"/>
                    <Button x:Name="BtnNavDashboard" Content="Dashboard" Style="{StaticResource BtnNav}" Click="BtnNavDashboard_Click" Margin="0,0,0,4"/>
                    <Button x:Name="BtnNavSettings" Content="Settings" Style="{StaticResource BtnNav}" Click="BtnNavSettings_Click"/>
                </StackPanel>
                <Border Grid.Row="2"/>
                <Border Grid.Row="3" x:Name="WarningBanner" CornerRadius="8" Padding="10,8" Margin="0,0,0,12"
                        Visibility="Collapsed" Background="#40FF6B6B" BorderBrush="#60FF6B6B" BorderThickness="1">
                    <DockPanel>
                        <Ellipse Width="7" Height="7" Fill="#FF6B6B" VerticalAlignment="Top" Margin="0,4,8,0" DockPanel.Dock="Left"/>
                        <TextBlock x:Name="WarningText" Foreground="#FFB3B3" FontSize="11" TextWrapping="Wrap" FontWeight="SemiBold"/>
                    </DockPanel>
                </Border>
                <StackPanel Grid.Row="4">
                    <Border Height="1" Background="#40FFFFFF" Margin="0,0,0,16"/>
                    <StackPanel Orientation="Horizontal" HorizontalAlignment="Center" Margin="0,0,0,10">
                        <Button x:Name="BtnLangEn" Content="EN" Style="{StaticResource BtnLang}" Click="BtnLangEn_Click" Margin="0,0,4,0"/>
                        <TextBlock Text="Â·" Foreground="{DynamicResource TextOnDarkMuted}" FontSize="14" FontWeight="Bold" VerticalAlignment="Center" Margin="2,0"/>
                        <Button x:Name="BtnLangFr" Content="FR" Style="{StaticResource BtnLang}" Click="BtnLangFr_Click" Margin="4,0,0,0"/>
                    </StackPanel>
                    <TextBlock x:Name="TxtJobCount" Text="0 job(s)" Foreground="{DynamicResource TextOnDarkMuted}" FontSize="10.5" HorizontalAlignment="Center" Margin="0,0,0,4"/>
                    <TextBlock Text="Â© ProSoft 2026" FontSize="9" Foreground="#60FFFFFF" HorizontalAlignment="Center"/>
                </StackPanel>
            </Grid>
        </Border>

        <!-- ===== MAIN CONTENT ===== -->
        <Grid Grid.Column="1">

            <!-- JOBS PAGE -->
            <Grid x:Name="JobsPage" Margin="32,28,32,20">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>  <!-- Row 0: Title + Execute All -->
                    <RowDefinition Height="Auto"/>  <!-- Row 1: Create form -->
                    <RowDefinition Height="*"/>     <!-- Row 2: Job list -->
                    <RowDefinition Height="Auto"/>  <!-- Row 3: V3 Active jobs encart (below list) -->
                    <RowDefinition Height="Auto"/>  <!-- Row 4: Status text -->
                </Grid.RowDefinitions>
                <Grid Grid.Row="0" Margin="0,0,0,20">
                    <TextBlock x:Name="TxtJobsTitle" Text="Backup Jobs" FontSize="22" FontWeight="Bold"
                               Foreground="{DynamicResource TextPrimary}" VerticalAlignment="Center"/>
                    <Button x:Name="BtnExecuteAll" Content="â–¶  Execute All" Style="{StaticResource BtnPrimary}"
                            HorizontalAlignment="Right" Click="BtnExecuteAll_Click" Padding="18,9"/>
                </Grid>
                <Border Grid.Row="1" Background="{DynamicResource BgCard}" CornerRadius="14" Padding="20,16" Margin="0,0,0,20">
                    <Border.Effect>
                        <DropShadowEffect BlurRadius="12" ShadowDepth="2" Opacity="0.06" Color="#553f2a"/>
                    </Border.Effect>
                    <StackPanel>
                        <TextBlock x:Name="TxtCreateTitle" Text="Create New Job" FontSize="14" FontWeight="SemiBold"
                                   Foreground="{DynamicResource TextPrimary}" Margin="0,0,0,12"/>
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="1.3*"/>
                                <ColumnDefinition Width="1.3*"/>
                                <ColumnDefinition Width="140"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <StackPanel Grid.Column="0" Margin="0,0,8,0">
                                <TextBlock x:Name="LblFormName" Text="Name" Foreground="{DynamicResource TextMuted}" FontSize="10.5" Margin="0,0,0,4"/>
                                <TextBox x:Name="TxtName" Style="{StaticResource CardInputStyle}"/>
                            </StackPanel>
                            <StackPanel Grid.Column="1" Margin="0,0,8,0">
                                <TextBlock x:Name="LblFormSource" Text="Source" Foreground="{DynamicResource TextMuted}" FontSize="10.5" Margin="0,0,0,4"/>
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBox x:Name="TxtSource" Style="{StaticResource CardInputStyle}" Grid.Column="0"/>
                                    <Button Grid.Column="1" Content="ðŸ“" Style="{StaticResource BtnIcon}" Width="34" Height="34" Margin="4,0,0,0"
                                            Click="BtnBrowseSource_Click" ToolTip="Browse..."/>
                                </Grid>
                            </StackPanel>
                            <StackPanel Grid.Column="2" Margin="0,0,8,0">
                                <TextBlock x:Name="LblFormTarget" Text="Target" Foreground="{DynamicResource TextMuted}" FontSize="10.5" Margin="0,0,0,4"/>
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBox x:Name="TxtTarget" Style="{StaticResource CardInputStyle}" Grid.Column="0"/>
                                    <Button Grid.Column="1" Content="ðŸ“" Style="{StaticResource BtnIcon}" Width="34" Height="34" Margin="4,0,0,0"
                                            Click="BtnBrowseTarget_Click" ToolTip="Browse..."/>
                                </Grid>
                            </StackPanel>
                            <StackPanel Grid.Column="3" Margin="0,0,8,0">
                                <TextBlock x:Name="LblFormType" Text="Type" Foreground="{DynamicResource TextMuted}" FontSize="10.5" Margin="0,0,0,4"/>
                                <ComboBox x:Name="CmbType" Style="{StaticResource CardComboStyle}" Height="34" VerticalContentAlignment="Center">
                                    <ComboBoxItem Content="Full" IsSelected="True"/>
                                    <ComboBoxItem Content="Differential"/>
                                </ComboBox>
                            </StackPanel>
                            <Button Grid.Column="4" x:Name="BtnCreate" Content="ï¼‹  Add" Style="{StaticResource BtnPrimary}"
                                    VerticalAlignment="Bottom" Padding="20,8" Click="BtnCreate_Click"/>
                        </Grid>
                    </StackPanel>
                </Border>

                <!-- JOB LIST - scrollbar uses themed ScrollBar style from CardStyles -->
                <ScrollViewer Grid.Row="2" VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Disabled" Margin="0,0,0,8">
                    <StackPanel x:Name="JobListPanel"/>
                </ScrollViewer>

                <!-- V3 - ACTIVE JOBS ENCART (below job list, compact) -->
                <Border Grid.Row="3" x:Name="ActiveJobsEncart" Visibility="Collapsed" Margin="0,0,0,0"
                        Background="{DynamicResource BgCard}" CornerRadius="10" Padding="12,8">
                    <Border.Effect>
                        <DropShadowEffect BlurRadius="6" ShadowDepth="1" Opacity="0.04" Color="#553f2a"/>
                    </Border.Effect>
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>
                        <DockPanel Grid.Row="0" Margin="0,0,0,6">
                            <TextBlock x:Name="TxtActiveJobsCount" Text="0 active jobs" Foreground="{DynamicResource TextSecondary}" 
                                       FontSize="11" FontWeight="SemiBold" VerticalAlignment="Center" DockPanel.Dock="Left"/>
                            <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                                <Button x:Name="BtnPauseAll" Content="â”‚â”‚ Pause All" Style="{StaticResource BtnPrimary}" 
                                        Padding="10,4" Margin="0,0,4,0" FontSize="10" Click="BtnPauseAll_Click"/>
                                <Button x:Name="BtnResumeAll" Content="â–¶ Resume All" Style="{StaticResource BtnPrimary}" 
                                        Padding="10,4" Margin="0,0,4,0" FontSize="10" Click="BtnResumeAll_Click"/>
                                <Button x:Name="BtnStopAll" Content="â–  Stop All" Style="{StaticResource BtnPrimary}" 
                                        Padding="10,4" FontSize="10" Click="BtnStopAll_Click"/>
                            </StackPanel>
                        </DockPanel>
                        <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Disabled" 
                                      MaxHeight="140" Margin="0,0,0,0">
                            <ItemsControl x:Name="ProgressItemsControl"/>
                        </ScrollViewer>
                    </Grid>
                </Border>
                <TextBlock Grid.Row="4" x:Name="TxtStatus" Text="Ready" Foreground="{DynamicResource TextMuted}" FontSize="11" Margin="0,8,0,0"/>
            </Grid>

            <!-- DASHBOARD PAGE (cards generated in code-behind) -->
            <Grid x:Name="DashboardPage" Visibility="Collapsed" Margin="32,28,32,20">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>
                <TextBlock x:Name="TxtDashboardTitle" Text="Dashboard" FontSize="22" FontWeight="Bold"
                           Foreground="{DynamicResource TextPrimary}" Margin="0,0,0,24"/>
                <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto">
                    <WrapPanel x:Name="DashboardCards" Orientation="Horizontal"/>
                </ScrollViewer>
            </Grid>

            <!-- SETTINGS PAGE -->
            <Grid x:Name="SettingsPage" Visibility="Collapsed" Margin="32,28,32,20">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>
                <TextBlock x:Name="TxtSettingsTitle" Text="Settings" FontSize="22" FontWeight="Bold"
                           Foreground="{DynamicResource TextPrimary}" Margin="0,0,0,20"/>
                <Border Grid.Row="1" Background="{DynamicResource BgCard}" CornerRadius="10" Padding="4" Margin="0,0,0,24" HorizontalAlignment="Left">
                    <StackPanel Orientation="Horizontal">
                        <Button x:Name="BtnTabGeneral" Content="General" Style="{StaticResource BtnTab}" Click="BtnTabGeneral_Click"/>
                        <Button x:Name="BtnTabLogs" Content="Logs" Style="{StaticResource BtnTab}" Click="BtnTabLogs_Click"/>
                        <Button x:Name="BtnTabLanguage" Content="Language" Style="{StaticResource BtnTab}" Click="BtnTabLanguage_Click"/>
                        <Button x:Name="BtnTabTheme" Content="Theme" Style="{StaticResource BtnTab}" Click="BtnTabTheme_Click"/>
                    </StackPanel>
                </Border>
                <ScrollViewer Grid.Row="2" VerticalScrollBarVisibility="Auto">
                    <Grid>
                        <!-- GENERAL -->
                        <StackPanel x:Name="TabGeneralContent" MaxWidth="500" HorizontalAlignment="Left">
                            <TextBlock x:Name="LblSettingsBusiness" Text="Business Software Detection" FontSize="15" FontWeight="SemiBold" Foreground="{DynamicResource TextPrimary}" Margin="0,0,0,6"/>
                            <TextBlock x:Name="LblSettingsBusinessDesc" Text="Process name to monitor (e.g. calc.exe)" Foreground="{DynamicResource TextMuted}" FontSize="11" Margin="0,0,0,12"/>
                            <TextBox x:Name="TxtBusinessSoftware" Style="{StaticResource CardInputStyle}" Text="CalculatorApp" TextChanged="TxtBusinessSoftware_TextChanged" Margin="0,0,0,8"/>
                            <StackPanel Orientation="Horizontal" Margin="0,0,0,28">
                                <Ellipse x:Name="MonitorDot" Width="7" Height="7" Fill="#5A7247" VerticalAlignment="Center" Margin="0,0,6,0"/>
                                <TextBlock x:Name="LblMonitorStatus" Text="Not detected" Foreground="#5A7247" FontSize="11" VerticalAlignment="Center"/>
                            </StackPanel>
                            <TextBlock x:Name="LblSettingsEncryption" Text="Encryption" FontSize="15" FontWeight="SemiBold" Foreground="{DynamicResource TextPrimary}" Margin="0,0,0,12"/>
                            <TextBlock x:Name="LblSettingsEncKey" Text="Encryption Key" Foreground="{DynamicResource TextMuted}" FontSize="11" Margin="0,0,0,4"/>
                            <Grid Margin="0,0,0,14">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>
                                <TextBox x:Name="TxtEncryptionKey" Style="{StaticResource CardInputStyle}" 
                                         LostFocus="TxtEncryptionKey_LostFocus" Grid.Column="0" Visibility="Collapsed"/>
                                <PasswordBox x:Name="PwdEncryptionKey" 
                                             Background="#F5E6D3" Foreground="#553f2a" BorderBrush="#DBBFA0" BorderThickness="1"
                                             Padding="12,9" FontSize="12" FontFamily="Segoe UI"
                                             Grid.Column="0" LostFocus="PwdEncryptionKey_LostFocus"/>
                                <Button Grid.Column="1" x:Name="BtnToggleKeyVisibility" Content="ðŸ‘" Style="{StaticResource BtnIcon}" 
                                        Width="34" Height="34" Margin="4,0,0,0"
                                        Click="BtnToggleKeyVisibility_Click" ToolTip="Show/Hide key"/>
                            </Grid>
                            <TextBlock x:Name="LblSettingsEncExt" Text="Target Extensions" Foreground="{DynamicResource TextMuted}" FontSize="11" Margin="0,0,0,4"/>
                            <TextBox x:Name="TxtEncryptionExtensions" Style="{StaticResource CardInputStyle}" Text=".txt, .md, .pdf" LostFocus="TxtEncryptionExtensions_LostFocus"/>
                            <TextBlock x:Name="LblSettingsLargeFile" Text="Large File Threshold (Ko)" FontSize="15" FontWeight="SemiBold" Foreground="{DynamicResource TextPrimary}" Margin="0,20,0,6"/>
                            <TextBlock x:Name="LblSettingsLargeFileDesc" Text="Only one file above this size transfers at a time (0 = disabled)" Foreground="{DynamicResource TextMuted}" FontSize="11" Margin="0,0,0,4"/>
                            <TextBox x:Name="TxtLargeFileThreshold" Style="{StaticResource CardInputStyle}" Text="1000" LostFocus="TxtLargeFileThreshold_LostFocus"/>
                            <TextBlock x:Name="LblSettingsPriorityExt" Text="Priority extensions (V3)" FontSize="15" FontWeight="SemiBold" Foreground="{DynamicResource TextPrimary}" Margin="0,20,0,6"/>
                            <TextBlock x:Name="LblSettingsPriorityExtDesc" Text="Comma-separated; these files are saved before others across all jobs (empty = no priority)" Foreground="{DynamicResource TextMuted}" FontSize="11" Margin="0,0,0,4"/>
                            <TextBox x:Name="TxtPriorityExtensions" Style="{StaticResource CardInputStyle}" LostFocus="TxtPriorityExtensions_LostFocus"/>
                        </StackPanel>
                        <!-- LOGS -->
                        <StackPanel x:Name="TabLogsContent" Visibility="Collapsed" MaxWidth="500" HorizontalAlignment="Left">
                            <TextBlock x:Name="LblSettingsLogFormat" Text="Log Format" FontSize="15" FontWeight="SemiBold" Foreground="{DynamicResource TextPrimary}" Margin="0,0,0,6"/>
                            <TextBlock x:Name="LblSettingsLogDesc" Text="Choose output format" Foreground="{DynamicResource TextMuted}" FontSize="11" Margin="0,0,0,16"/>
                            <StackPanel Orientation="Horizontal">
                                <Button x:Name="BtnLogJson" Content="JSON" Style="{StaticResource BtnTab}" Padding="24,10" Click="BtnLogJson_Click" Margin="0,0,8,0"/>
                                <Button x:Name="BtnLogXml" Content="XML" Style="{StaticResource BtnTab}" Padding="24,10" Click="BtnLogXml_Click"/>
                            </StackPanel>

                            <TextBlock x:Name="LblSettingsLogMode" Text="Transmission Mode" FontSize="15" 
               FontWeight="SemiBold" Foreground="{DynamicResource TextPrimary}" Margin="0,20,0,6"/>
                            <TextBlock x:Name="LblSettingsLogModeDesc" Text="Choose where logs are stored" 
               Foreground="{DynamicResource TextMuted}" FontSize="11" Margin="0,0,0,12"/>

                            <ComboBox x:Name="CmbLogMode" Style="{StaticResource CardComboStyle}" 
              Height="34" Width="200" HorizontalAlignment="Left"
              SelectionChanged="CmbLogMode_SelectionChanged">
                                <ComboBoxItem Content="Local" Tag="Local"/>
                                <ComboBoxItem Content="Centralized" Tag="Centralized"/>
                                <ComboBoxItem Content="Both" Tag="Both"/>
                            </ComboBox>
                        </StackPanel>
                        <!-- LANGUAGE -->
                        <StackPanel x:Name="TabLanguageContent" Visibility="Collapsed" MaxWidth="500" HorizontalAlignment="Left">
                            <TextBlock x:Name="LblSettingsLangTitle" Text="Application Language" FontSize="15" FontWeight="SemiBold" Foreground="{DynamicResource TextPrimary}" Margin="0,0,0,6"/>
                            <TextBlock x:Name="LblSettingsLangDesc" Text="Select your preferred language" Foreground="{DynamicResource TextMuted}" FontSize="11" Margin="0,0,0,16"/>
                            <StackPanel Orientation="Horizontal">
                                <Button x:Name="BtnSettingsLangEn" Content="English" Style="{StaticResource BtnTab}" Padding="24,10" Click="BtnSettingsLangEn_Click" Margin="0,0,8,0"/>
                                <Button x:Name="BtnSettingsLangFr" Content="FranÃ§ais" Style="{StaticResource BtnTab}" Padding="24,10" Click="BtnSettingsLangFr_Click"/>
                            </StackPanel>
                        </StackPanel>
                        <!-- THEME (swatches generated in code-behind) -->
                        <StackPanel x:Name="TabThemeContent" Visibility="Collapsed" MaxWidth="600" HorizontalAlignment="Left">
                            <TextBlock x:Name="LblSettingsThemeTitle" Text="Color Theme" FontSize="15" FontWeight="SemiBold" Foreground="{DynamicResource TextPrimary}" Margin="0,0,0,6"/>
                            <TextBlock x:Name="LblSettingsThemeDesc" Text="Select your preferred color palette" Foreground="{DynamicResource TextMuted}" FontSize="11" Margin="0,0,0,20"/>
                            <WrapPanel x:Name="ThemeSwatchPanel" Orientation="Horizontal"/>
                            <TextBlock x:Name="TxtCurrentTheme" Text="Active: Caramel Profond" Foreground="{DynamicResource TextSecondary}" FontSize="11" FontWeight="SemiBold" Margin="0,8,0,0"/>
                        </StackPanel>
                    </Grid>
                </ScrollViewer>
            </Grid>

            <!-- NOTIFICATION TOAST -->
            <Border x:Name="NotificationToast" HorizontalAlignment="Right" VerticalAlignment="Bottom"
                    Margin="0,0,24,24" Opacity="0" IsHitTestVisible="False" CornerRadius="12" Padding="16,12" MaxWidth="380" MinWidth="220">
                <Border.Background>
                    <SolidColorBrush x:Name="NotifBg" Color="#F2E0CE"/>
                </Border.Background>
                <Border.Effect>
                    <DropShadowEffect BlurRadius="16" ShadowDepth="3" Opacity="0.10" Color="#553f2a"/>
                </Border.Effect>
                <StackPanel Orientation="Horizontal">
                    <Ellipse x:Name="NotifDot" Width="8" Height="8" Fill="#a67847" VerticalAlignment="Center" Margin="0,0,10,0"/>
                    <TextBlock x:Name="NotifText" Foreground="{DynamicResource TextPrimary}" FontSize="12" FontWeight="SemiBold" TextWrapping="Wrap" MaxWidth="320"/>
                </StackPanel>
            </Border>
        </Grid>
    </Grid>
</Window>
